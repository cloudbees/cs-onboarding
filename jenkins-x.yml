buildPack: none
pipelineConfig:
  pipelines:
    pullRequest:
      pipeline:
        agent:
          image: gcr.io/kaniko-project
        stages:
        - name: build
          steps:
          - image: jojomi/hugo:0.61.0
            name: version
            command: hugo
            args:
            - version

          - image: jojomi/hugo:0.61.0
            name: build-website
            command: hugo
            args:
            - -D
            - -d
            - tmp-website
            - --enableGitInfo
            - --baseURL http://localhost:8080/

          - image: gcr.io/kaniko-project/executor:9912ccbf8d22bbafbf971124600fbb0b13b9cbd6
            name: build-and-push-image
            command: /kaniko/executor
            args:
            - --dockerfile=/workspace/source/Dockerfile
            - --destination=gcr.io/na-csa-msuarez/cs-onboarding:${inputs.params.version}
            - --context=/workspace/source
            - --cache-dir=/workspace